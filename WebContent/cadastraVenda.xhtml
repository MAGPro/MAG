<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition template="/pages/_template.xhtml">
	<ui:define name="conteudo">
		<h:form>
			<p:messages id="messages" autoUpdate="true" closable="true" />
		</h:form>
		<center><H3>Cadastrar Venda</H3></center>
		<h:form>
			<p:tabView>
				<p:tab title="Fazer Venda - Passo 1/3">
					<p:panelGrid columns="6" cellpadding="2">
						<p:outputLabel value="Data:" for="dataVenda" />
						<p:calendar pattern="dd/MM/yyyy" id="dataVenda"
							value="#{vendaMB.venda.dataVenda.time}" />

						<p:outputLabel value="Quantidade" />
						<p:inputText value="#{vendaMB.item.quantidade}" size="4" />

						<p:outputLabel value="Selecione o produto" />
						<h:panelGroup>
							<p:selectOneMenu value="#{vendaMB.idProduto}">
								<f:selectItems value="#{produtoMB.produtos}" var="p"
									itemValue="#{p.id}" itemLabel="#{p.descricao}" />
							</p:selectOneMenu>
						</h:panelGroup>

						<h:commandButton action="#{vendaMB.adicionarItem}"
							value="Adicionar Item" update="tabelaItens">
						</h:commandButton>

						<h:panelGroup>
							<p:outputLabel value="Sub Total" />
							<h:outputText id="tvenda" value="#{vendaMB.venda.valorTotal}" />
						</h:panelGroup>

						<p:outputLabel value="Desconto R$(-)" />
						<p:inputText value="#{vendaMB.venda.desconto}" size="4"/>

						<!--  <h:commandButton action=""
							value="Total">
						</h:commandButton>-->
					</p:panelGrid>
					
					<p:dataTable value="#{vendaMB.venda.itens}" var="item" id="tabelaItens">

						<p:column headerText="Produto">
							<h:outputText value="#{item.produto.descricao}" />
						</p:column>

						<p:column headerText="Valor">
							<h:outputText value="#{item.valorVenda}">
								<f:convertNumber pattern="R$ #0.00" />
							</h:outputText>
						</p:column>

						<p:column headerText="Quantidade">
							<h:outputText value="#{item.quantidade}" />
						</p:column>
						<p:column headerText="Total">
							<h:outputText value="#{item.total}">
								<f:convertNumber pattern="R$ #0.00" />
							</h:outputText>
						</p:column>
					</p:dataTable>
				</p:tab>

				<p:tab title="Forma de Pagamento - Passo 2/3">
					<!--  --><h:form id="pagamento">
						<h:panelGrid columns="2" cellpadding="10">

							<p:outputLabel value="Selecione a Forma de Pagamento" />
							<h:panelGroup>
								<p:selectOneMenu value="#{vendaMB.venda.formaPagamento}">
									<f:selectItems value="#{vendaMB.tipos}" var="t"
										itemValue="#{t}" itemLabel="#{t.label}" />
								</p:selectOneMenu>
							</h:panelGroup>

							<p:outputLabel value="Selecione o Cliente" />
							<h:panelGroup>
								<p:selectOneMenu value="#{vendaMB.idCliente}">
									<f:selectItems value="#{clienteMB.clientes}" var="c"
										itemValue="#{c.id}" itemLabel="#{c.nome}" />
								</p:selectOneMenu>
							</h:panelGroup>
						</h:panelGrid>
					</h:form>
				</p:tab>

				<p:tab title="Resumo Final - Passo 3/3">

					<p:panelGrid columns="2">
						<h:outputText value="Cliente" />
						<h:outputText value="#{vendaMB.venda.cliente.nome}" />
						<h:outputText value="Forma de Pagamento" />
						<h:outputText value="#{vendaMB.venda.formaPagamento}" />
						<h:outputText value="Valor Total" />
						<h:outputText value="#{vendaMB.venda.valorTotal}" />
					</p:panelGrid>
					<p:dataTable value="#{vendaMB.venda.itens}" var="item">

						<p:column headerText="Produto">
							<h:outputText value="#{item.produto.descricao}" />
						</p:column>

						<p:column headerText="Valor">
							<h:outputText value="#{item.valorVenda}">
								<f:convertNumber pattern="R$ #0.00" />
							</h:outputText>
						</p:column>

						<p:column headerText="Quantidade">
							<h:outputText value="#{item.quantidade}" />
						</p:column>
						<p:column headerText="Total" colspan="2">
							<h:outputText value="#{item.total}">
								<f:convertNumber pattern="R$ #0.00" />
							</h:outputText>
						</p:column>
					</p:dataTable>
					<center>
						<p:commandButton value="Finalizar" action="#{vendaMB.adicionar}" />
					</center>
				</p:tab>

			</p:tabView>
		</h:form>
	</ui:define>
</ui:composition>
</html>
